@(results: List[models.TaxYearResults])(implicit request:Request[_])

@common.paacMain(
pageTitle = Messages("paac.calculator.results.heading"),
heading = Messages("paac.calculator.results.pagetitle"),
mainClass = "main",
articleClasses=Some("full-width"),
backLink = Some((controllers.routes.ReviewTotalAmountsController.onPageLoad.url,Messages("paac.link.text.back")))
) {
    <table>
       <thead>
       <tr>
         <th class="numeric" scope="col">@Messages("paac.results.table.col.1")</th>
         <th class="numeric" scope="col">@Messages("paac.results.table.col.2")</th>
         <th class="numeric" scope="col">@Messages("paac.results.table.col.3")</th>
         <th class="numeric" scope="col">@Messages("paac.results.table.col.4")</th>
         <th class="numeric" scope="col">@Messages("paac.results.table.col.5")</th>
         <th class="numeric" scope="col">@Messages("paac.results.table.col.6")</th>
         <th class="numeric" scope="col">@Messages("paac.results.table.col.7")</th>
         <th class="numeric" scope="col">@Messages("paac.results.table.col.8")</th>
       </tr>
       </thead>
       <tbody>
  @defining(java.text.NumberFormat.getCurrencyInstance(java.util.Locale.UK)) { currencyFormatter =>
  @defining(results.sortWith(_.input.taxPeriodStart.year < _.input.taxPeriodStart.year).dropWhile((v)=>v.input.isEmpty)) { sortedResults =>
    @sortedResults.map { result =>
      @if(result.input.amounts.isDefined) {
       <tr>
          <td>@result.input.taxYearLabel</td>
          <td class="numeric">
          @if(result.input.amounts.get.definedBenefit.isDefined || result.input.amounts.get.definedBenefit.get > 0) {
            @(currencyFormatter.format(result.input.amounts.get.definedBenefit.get/100.00))
          } else {
            N/A
          }
          </td>
          <td class="numeric">
          @if(result.input.taxPeriodStart.year<2015) {
            N/A
          } else {
            @(currencyFormatter.format(result.input.amounts.get.moneyPurchase.get/100.00))
          }
          </td>
          <td class="numeric">@(currencyFormatter.format(result.summaryResult.exceedingAAAmount/100.00))</td>
          <td class="numeric">@(currencyFormatter.format(result.summaryResult.availableAAWithCF/100.00))</td>
          <td class="numeric">
          @if(result.summaryResult.chargableAmount<0) {
            N/A
          } else {
            @(currencyFormatter.format(result.summaryResult.chargableAmount/100.00))
          }
          </td>
          <td class="numeric">@(currencyFormatter.format(result.summaryResult.unusedAllowance/100.00))</td>
          <td class="numeric">@(currencyFormatter.format(result.summaryResult.availableAAWithCCF/100.00))</td>
       </tr>
      }
    }
  }
  }
       </tbody>
    </table>
    <a href="@Messages("paac.results.link.new.href")">@Messages("paac.results.link.new")</a>
}